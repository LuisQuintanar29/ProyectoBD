sudo service postgresql start
sudo -i -u postgres psql

CREATE DATABASE papeleria;

\c papeleria

DROP TABLE IF EXISTS cliente CASCADE;
DROP TABLE IF EXISTS compañia CASCADE;
DROP TABLE IF EXISTS consumo CASCADE;
DROP TABLE IF EXISTS email CASCADE;
DROP TABLE IF EXISTS impresion CASCADE;
DROP TABLE IF EXISTS inventario CASCADE;
DROP TABLE IF EXISTS preciorecarga CASCADE;
DROP TABLE IF EXISTS producto CASCADE;
DROP TABLE IF EXISTS proveedor CASCADE;
DROP TABLE IF EXISTS recarga CASCADE;
DROP TABLE IF EXISTS tamañohoja CASCADE;
DROP TABLE IF EXISTS telefono CASCADE;
DROP TABLE IF EXISTS tipoimpresion CASCADE;
DROP TABLE IF EXISTS tipoproducto CASCADE;

CREATE TABLE cliente(
RFC varchar(13) NOT NULL,
NombreCliente varchar(70) NOT NULL ,
EstadoCliente varchar(70) NOT NULL,
ColoniaCliente varchar(70) NOT NULL,
CalleCliente varchar(70) NOT NULL,
CPCliente int NOT NULL,
NumeroCliente int NOT NULL,
CONSTRAINT cliente_PK PRIMARY KEY (RFC)
);

CREATE TABLE email(
Email varchar(50) NOT NULL,
RFC varchar(13) NOT NULL,
CONSTRAINT email_PK PRIMARY KEY (Email),
CONSTRAINT email_cliente_FK FOREIGN KEY (RFC) REFERENCES cliente(RFC) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE proveedor(
RazonSocial varchar(30) NOT NULL,
NombreProv varchar(70) NOT NULL,
EstadoProv varchar(70) NOT NULL,
ColoniaProv varchar(70) NOT NULL,
CalleProv varchar(70) NOT NULL,
CPProv int NOT NULL,
NumeroProv int NOT NULL,
CONSTRAINT proveedor_PK PRIMARY KEY (RazonSocial)
);

CREATE TABLE telefono(
Telefono int NOT NULL,
RazonSocial varchar(30) NOT NULL,
CONSTRAINT telefono_PK PRIMARY KEY (Telefono),
CONSTRAINT telefono_proveedor_FK FOREIGN KEY (RazonSocial) REFERENCES proveedor (RazonSocial) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE inventario(
CodigoBarras int NOT NULL,
PrecioCompra int NOT NULL,
FechaCompra date NOT NULL,
Stock int NOT NULL,
CONSTRAINT inventario_PK PRIMARY KEY (CodigoBarras)
);

CREATE TABLE tipoproducto(
IDTipoProd serial,
TipoProducto varchar(30) NOT NULL,
CONSTRAINT tipoproducto_PK PRIMARY KEY (IDTipoProd)
);

CREATE TABLE producto(
CodigoBarras int NOT NULL,
PrecioProd int NOT NULL,
Marca varchar(15) NOT NULL,
DescripcionProd varchar(30) NOT NULL,
IDTipoProd int NOT NULL,
CONSTRAINT producto_PK PRIMARY KEY (CodigoBarras),
CONSTRAINT productoCodBar_inventario_FK FOREIGN KEY (CodigoBarras) REFERENCES inventario (CodigoBarras) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT producto_tipoproducto_FK FOREIGN KEY (IDTipoProd) REFERENCES tipoproducto (IDTipoProd) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE impresion(
IDImpresion serial,
TamañoHoja varchar(15) NOT NULL,
TipoImpresion varchar(15) NOT NULL,
PrecioServ int NOT NULL,
DescripcionServ varchar(30) NOT NULL,
CONSTRAINT impresion_PK PRIMARY KEY (IDImpresion)
);

CREATE TABLE recarga(
IDRecarga serial,
Compañia varchar(30) NOT NULL,
PrecioRecarga int NOT NULL,
DescripcionServ varchar(30) NOT NULL,
CONSTRAINT recarga_PK PRIMARY KEY (IDRecarga)
);

CREATE TABLE consumo(
NoVenta serial,
FechaVenta date NOT NULL,
CantidadArticulo int NOT NULL,
PrecioArticulo int NOT NULL,
CodigoBarras int,
IDImpresion int,
IDRecarga int,
Total int GENERATED ALWAYS AS (CantidadArticulo*PrecioArticulo) STORED,
CONSTRAINT consumo_PK PRIMARY KEY (NoVenta),
CONSTRAINT consumoCodBar_inventario_FK FOREIGN KEY (CodigoBarras) REFERENCES inventario (CodigoBarras) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT consumo_Impresion_FK FOREIGN KEY (IDImpresion) REFERENCES impresion (IDImpresion) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT consumo_recarga_FK FOREIGN KEY (IDRecarga) REFERENCES recarga (IDRecarga) ON DELETE CASCADE ON UPDATE CASCADE
);

INSERT INTO tipoproducto (TipoProducto) VALUES ('Regalo');
INSERT INTO tipoproducto (TipoProducto) VALUES ('Articulo de papeleria');


INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A0','Blanco/Negro',1,'Impresion A0 Blanco y Negro');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A0','Color',2,'Impresion A0 a Color');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A1','Blanco/Negro',2,'Impresion A1 Blanco y Negro');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A1','Color',3,'Impresion A1 a Color');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A2','Blanco/Negro',3,'Impresion A2 Blanco y Negro');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A2','Color',4,'Impresion A2 a Color');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A3','Blanco/Negro',4,'Impresion A3 Blanco y Negro');
INSERT INTO impresion (TamañoHoja,TipoImpresion,PrecioServ,DescripcionServ) VALUES ('A3','Color',5,'Impresion A3 a Color');


INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',10,'Recarga Movistar de 10 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',20,'Recarga Movistar de 20 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',30,'Recarga Movistar de 30 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',50,'Recarga Movistar de 50 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',100,'Recarga Movistar de 100 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',200,'Recarga Movistar de 200 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Movistar',500,'Recarga Movistar de 500 pesos');

INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',10,'Recarga Telcel de 10 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',20,'Recarga Telcel de 20 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',30,'Recarga Telcel de 30 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',50,'Recarga Telcel de 50 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',100,'Recarga Telcel de 100 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',200,'Recarga Telcel de 200 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('Telcel',500,'Recarga Telcel de 500 pesos');

INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',10,'Recarga UNEFON de 10 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',20,'Recarga UNEFON de 20 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',30,'Recarga UNEFON de 30 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',50,'Recarga UNEFON de 50 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',100,'Recarga UNEFON de 100 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',200,'Recarga UNEFON de 200 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('UNEFON',500,'Recarga UNEFON de 500 pesos');

INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',10,'Recarga AT&T de 10 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',20,'Recarga AT&T de 20 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',30,'Recarga AT&T de 30 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',50,'Recarga AT&T de 50 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',100,'Recarga AT&T de 100 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',200,'Recarga AT&T de 200 pesos');
INSERT INTO recarga (Compañia,PrecioRecarga,DescripcionServ) VALUES ('AT&T',500,'Recarga AT&T de 500 pesos');


SELECT * FROM tipoproducto;
SELECT * FROM recarga;
SELECT * FROM impresion;
